# Лекция 2: Практическое задание 


> [!Задание первое]
> Осуществите подключение к кластеру ADB. Опишите системные таблицы и представления кластера в схемах arenadata_toolkit и gp_toolkit (только представления) по правилу: наименование – какую информацию содержит – для чего применяется.
> Используйте в ответах материалы из документации.
Формат ответа: таблица с перечнем объектов, xls


##### Схема arenadata_toolkit:
 - **Таблицы**
```SQL
SELECT table_schema AS schema_name,
	   table_name
FROM information_schema.tables
WHERE table_schema = 'arenadata_toolkit';
```

| schema_name       | table_name        | Содержит                                                                                                                                                                                                                                                                                                                                                           | Применяется                                                                                                |
| ----------------- | ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------- |
| arenadata_toolkit | db_files_current  | актуальную на момент последнего запуска скрипта [collect_table_stats](https://docs.arenadata.io/ru/ADB/current/how-to/manage-cluster/toolkit.html#script-purpose) информацию о файлах БД на всех сегментах кластера с привязкой к таблицам, индексам и другим объектам БД (при возможности определения таких связей). Перезаписывается при каждом запуске скрипта. | для мониторинга и отладки системы.                                                                         |
| arenadata_toolkit | db_files_history  | хранит историю изменений файлов БД на всех сегментах кластера с привязкой к таблицам, индексам и другим объектам БД. Обновляется ежедневно при каждом запуске скрипта [collect_table_stats](https://docs.arenadata.io/ru/ADB/current/how-to/manage-cluster/toolkit.html#script-purpose) и не очищается.                                                            | для отслеживания динамики изменения размера БД.                                                            |
| arenadata_toolkit | daily_operation   | информацию об операциях `VACUUM` и `ANALYZE`, проводимых над таблицами базы данных автоматически по расписанию. Обновляется ежедневно при запуске соответствующих скриптов [vacuum, analyze, vacuum_analyze_pg_catalog](https://docs.arenadata.io/ru/ADB/current/how-to/manage-cluster/toolkit.html#script-purpose).                                               | для анализа и оптимизации процесса хранения данных                                                         |
| arenadata_toolkit | operation_exclude | информацию о схемах БД, к которым не требуется применять операции `VACUUM` и `ANALYZE` при запуске соответствующих скриптов [vacuum и analyze](https://docs.arenadata.io/ru/ADB/current/how-to/manage-cluster/toolkit.html#script-purpose).                                                                                                                        | управление и мониторинг использования ресурсов, позволяя исключать ненужные операции для определенных схем |
- **Пердставления**
```SQL
SELECT table_schema AS schema_name,
	   table_name AS view_name
FROM information_schema.views
WHERE table_schema = 'arenadata_toolkit';
```
**0**
##### Схема gp_toolkit:
- **Пердставления**
```SQL
SELECT table_schema AS schema_name,
	   table_name AS view_name
FROM information_schema.views
WHERE table_schema = 'gp_toolkit';
```

| **schema_name** | **view_name**                          | **Содержит**                                              | **Применяется**                                           |
| --------------- | -------------------------------------- | --------------------------------------------------------- | --------------------------------------------------------- |
| gp_toolkit      | __gp_is_append_only                    | Информацию о том, является ли таблица append-only         | Оптимизация вставки данных                                |
| gp_toolkit      | __gp_fullname                          | Полные имена объектов БД                                  | Получение ссылок на объекты с полным именем               |
| gp_toolkit      | __gp_user_namespaces                   | Список пользовательских namespaces                        | Управление пространствами имен                            |
| gp_toolkit      | __gp_user_tables                       | Информация о пользовательских таблицах                    | Учет таблиц, созданных пользователями                     |
| gp_toolkit      | __gp_user_data_tables                  | Список пользовательских таблиц                            | Управление пользовательскими данными                      |
| gp_toolkit      | __gp_user_data_tables_readable         | Пользовательские таблицы с данными, доступными для чтения | Анализа читаемых таблиц                                   |
| gp_toolkit      | __gp_number_of_segments                | Количество сегментов в кластере                           | Анализа распределения данных                              |
| gp_toolkit      | gp_log_system                          | Логи системных событий                                    | Анализ системных событий и ошибок                         |
| gp_toolkit      | gp_log_database                        | Логи событий базы данных                                  | Общий анализ и отладка БД                                 |
| gp_toolkit      | gp_log_master_concise                  | Краткие логи мастера                                      | Быстрая диагностика проблем                               |
| gp_toolkit      | gp_log_command_timings                 | Временные метки выполнения команд                         | Анализ производительности выполнения команд               |
| gp_toolkit      | gp_param_settings_seg_value_diffs      | Различия в параметрах между сегментами                    | Проверка согласованности параметров на сегментах          |
| gp_toolkit      | gp_pgdatabase_invalid                  | Информацию о невалидных базах данных                      | Поиск и устранение аномалий в БД                          |
| gp_toolkit      | gp_skew_coefficients                   | Коэффициенты перекоса данных                              | Анализ распределения данных по сегментам                  |
| gp_toolkit      | gp_skew_idle_fractions                 | Доля простаивающих сегментов из-за skew                   | Анализ влияния skew на производительность                 |
| gp_toolkit      | gp_stats_missing                       | Информацию о отсутствии статистических данных             | Поиск таблиц без статистики для оптимизации запросов      |
| gp_toolkit      | gp_bloat_expected_pages                | Ожидаемое количество страниц для таблиц                   | Анализ bloat (раздувания) таблиц                          |
| gp_toolkit      | gp_bloat_diag                          | Диагностика раздувания таблиц                             | Поиск и устранение bloat в таблицах.                      |
| gp_toolkit      | gp_resq_activity                       | Активность ресурсных очередей                             | Мониторинг использования ресурсных очередей               |
| gp_toolkit      | gp_resq_activity_by_queue              | Активность ресурсов по очередям                           | Анализ загрузки ресурсных очередей                        |
| gp_toolkit      | gp_resq_priority_backend               | Приоритеты backend в ресурсных очередях                   | Анализ приоритетов выполнения запросов                    |
| gp_toolkit      | gp_resq_priority_statement             | Приоритеты SQL-запросов в ресурсных очередях.             | Анализ приоритетов выполнения SQL-запросов                |
| gp_toolkit      | gp_resq_role                           | Роли, связанные с ресурсными очередями                    | Анализ ролей, использующих ресурсные очереди              |
| gp_toolkit      | gp_locks_on_resqueue                   | Блокировки на ресурсных очередях                          | Мониторинг использования ресурсов                         |
| gp_toolkit      | gp_locks_on_relation                   | Блокировки на таблицах                                    | Анализ блокировок на таблицах                             |
| gp_toolkit      | gp_roles_assigned                      | Роли, назначенные пользователям                           | Управление назначенными ролями                            |
| gp_toolkit      | gp_size_of_index                       | Размер индексов                                           | Оптимизация размеров индексов                             |
| gp_toolkit      | gp_size_of_table_disk                  | Размер таблиц на диске                                    | Оптимизация хранения таблиц                               |
| gp_toolkit      | gp_size_of_table_uncompressed          | Размер таблиц в несжатом виде.                            | Оценка объема данных без учета сжатия                     |
| gp_toolkit      | gp_table_indexes                       | Индексы таблиц                                            | Получение списка индексов для таблиц                      |
| gp_toolkit      | gp_size_of_all_table_indexes           | Размер всех индексов таблиц                               | Анализ общего размера индексов                            |
| gp_toolkit      | gp_size_of_table_and_indexes_disk      | Размер таблиц и их индексов на диске                      | Полный анализ занимаемого места таблицами и индексами     |
| gp_toolkit      | gp_size_of_table_and_indexes_licensing | Размер таблиц и индексов для лицензирования.              | Оценка объема данных для лицензирования                   |
| gp_toolkit      | gp_size_of_partition_and_indexes_disk  | Размер партиций и их индексов на диске                    | Анализ занимаемого места партициями и их индексами        |
| gp_toolkit      | gp_size_of_schema_disk                 | Размер схемы на диске                                     | Оптимизация использования схем                            |
| gp_toolkit      | gp_size_of_database                    | Размер базы данных на диске.                              | Анализ занимаемого места базой данных.                    |
| gp_toolkit      | gp_resqueue_status                     | Статус ресурсных очередей                                 | Мониторинг состояния ресурсных очередей                   |
| gp_toolkit      | gp_resgroup_config                     | Конфигурация ресурсных групп                              | Получение информации о настройках ресурсных групп         |
| gp_toolkit      | gp_resgroup_status                     | Статус ресурсных групп                                    | Мониторинг состояния ресурсных групп                      |
| gp_toolkit      | gp_resgroup_status_per_host            | Статус ресурсных групп по хостам                          | Анализ распределения ресурсов по хостам                   |
| gp_toolkit      | gp_resgroup_status_per_segment         | Статус ресурсных групп по сегментам                       | Анализ распределения ресурсов по сегментам                |
| gp_toolkit      | gp_workfile_entries                    | Информацию о workfiles (временных файлах)                 | Анализ использования временных файлов                     |
| gp_toolkit      | gp_workfile_usage_per_segment          | Использование workfiles по сегментам                      | Анализ распределения временных файлов по сегментам        |
| gp_toolkit      | gp_workfile_usage_per_query            | Использование workfiles по запросам                       | Анализ использования временных файлов для каждого запроса |
| gp_toolkit      | gp_workfile_mgr_used_diskspace         | Используемое дисковое пространство для workfiles          | Мониторинг дискового пространства под временными файлами  |
